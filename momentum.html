<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <link rel="stylesheet" href="momentum.css">

</head>
<body>

<div class="bg "><div id="bg_item"></div></div>
<div class="top-row">
  <div class="region top-right">
    <div class="app-container">
      <div class="metric-item">
        <div>
        <span class="icon-weather"><img src="" class="icon1" alt=""/></span>

        <span class="metric-stat-number"></span><span class="weather-degree">°</span>
      </div>
        <div class="mertic-label"><span class="city">1212</span></div>

      </div>
    </div>
  </div>
</div>
<div class="center">
  <div class="currentTime">
 11
  </div>
  <form action="" class="js-form showing">
    <input type="text" placeholder="이름이 뭐야?">
  </form>
  <div class="greeting">hi, laughter98</div>


</div>

  <script>
  const clockTitle = document.querySelector(".currentTime"); //현재 시간 넣을 곳
  const bgItem = document.querySelector("#bg_item");
  const form = document.querySelector(".js-form");
  const input = document.querySelector("input");
  const myName = document.querySelector(".greeting");
  const cityName = document.querySelector(".city");
  const cityTemp = document.querySelector(".metric-stat-number");
  const cityWeather = document.querySelector(".icon-weather");
  const iconImg = document.querySelector(".icon1");
    function getTime(){
      const clock = new Date();
      const hour = clock.getHours();
      const minute = clock.getMinutes();
      const second = clock.getSeconds();
      clockTitle.innerText = `${hour < 10? `0${hour}`: hour} : ${minute <10 ? `0${minute}`: minute} `
      // clockTitle.innerText = hour + ":" + minute + ":" + second;
    }
    function bgFade(){
       bgItem.classList.add("fadein");

    }
    function saveName(text){
        localStorage.setItem("currentUser2",text);
    }
    function handleSubmit(){
      event.preventDefault();

      const currentValue = input.value;
      saveName(currentValue);
      myName.innerText = currentValue;
      myName.classList.add("showing");
      form.classList.remove("showing");
    }
    function askForName(){
      form.addEventListener("submit",handleSubmit);
    }
    function loadName(){
      const currentUser = localStorage.getItem("currentUser2");
      if( currentUser == ""){
          askForName();
      } else {
          form.classList.remove("showing");
            myName.classList.add("showing");
            myName.innerText = currentUser;
      }
    }
    function init(){
      getTime();
      setInterval(getTime,1000);

      loadName();
      window.addEventListener("load", bgFade)
    }
    init();
  </script>
  <script>
  var requestURL = "https://api.openweathermap.org/data/2.5/weather?lat=37.3682282&lon=127.1053683&appid=7af0627ce2afb5a0509635088573192c&units=metric"
  var request = new XMLHttpRequest();
  request.open('GET', requestURL);
request.responseType = 'json'; // now we're getting a string!
request.send();
request.onload = function() {

  const superHeroes = request.response;
  const rname = superHeroes.name;
  const temp = request.response.main.temp;
  const weather = superHeroes.weather[0].icon;
   cityName.innerText = rname;
   cityTemp.innerText = temp;
   // cityWeather.innerText = "http://openweathermap.org/img/wn/"+weather+"@2x.png";
   iconImg.src ="http://openweathermap.org/img/wn/"+weather+"@2x.png"
  // populateHeader(superHeroes);
  // showHeroes(superHeroes);
}


  </script>
  <script type='text/javascript'>

    var obj = JSON.parse('{"coord":{"lon":127.11,"lat":37.37},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"base":"stations","main":{"temp":0.61,"feels_like":-3.79,"temp_min":-1,"temp_max":2,"pressure":1026,"humidity":31},"visibility":10000,"wind":{"speed":1.5,"deg":180},"clouds":{"all":1},"dt":1582006205,"sys":{"type":1,"id":5509,"country":"KR","sunrise":1581977915,"sunset":1582017171},"timezone":32400,"id":1897000,"name":"Seongnam","cod":200}')
</script>
</body>
</html>
